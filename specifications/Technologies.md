
# Technologies in Use #

Here is some technology-based guidance.

## Folder structure ##

		+-*-.paket     // Package manager and bootsrtapper for it.
		+---backend    // Www-server
		|   +-*-bin    // Compiled executables
		|   +---sql    // SQL-scripts to create a database and demo data
		+---frontend   // Html-client
		|   +---styles // Development stylesheets
		|   +-*-dist   // Minified release-package
		|   +---fonts
		|   +---img
		|   +---scripts     // Development TypeScript and React.js components
		+-*-node_modules    // Development time Javascript components.
		+-*-packages        // Refereces to 3rd party server side packages.
		+-*-paket-files     // Refereces to 3rd party client side packages.
		+---specifications  // Documentations

Everything marked with a star (*) is autogenerated; you don't have to worry about it.
Some important files:

 - `.gitignore`: File that says what is not going to Git version control
 - `build.fsx`: Build script. This will be executed by `build.cmd` (Win) and `build.sh` (Mac/Linux)
 - `gulpfile.js`: Javascript task management
 - `paket.dependencies`: File that tells what to download from the internet. Based on this, Paket will update `paket.lock` and download the packages.
 - `*.fs`: Server-side FSharp-programming language files. Compiled to exe-file.
  
## Technology based instructions ##

### MarkDown ###

This documentation is created in the MarkDown format. You can use e.g. [MarkdownPad 2](http://markdownpad.com/) on Windows to create markdown files. Basically, markdown is just plain text files with some light formatting.

### Git ###

Git setup:

    git config --global user.name "Matti Meikalainen"
    git config --global user.email "matti.meikalainen@email.com"
    git config --global push.default simple

##### Basic Git commands: #####

- Get changes from the server: `git pull`
- Add files to git: `git add *`
- Check the status of files: `git status`
- Reset and delete all uncommitted changes: `git reset --HARD`
- Delete all files that are not in the git repository: `git clean -xdf`
- Save files to the local repository: `git commit -m "I did some modifications"`
- Send saved modifications to the server: `git push`

### Paket ###

Paket is a package management tool (a wrapper to NuGet) for multiple solutions. This will ensure that we have only one version of any NuGet-reference package.

Paket is located in the ".paket"-folder (after running .paket\paket.bootstrapper.exe in the backend folder), and you can run it from the command line.

- Windows: `.paket\paket.exe`
- Mac/Linux: `mono .paket\paket.exe`

To get help add --help to the parameters. To get more info on what happens, add --verbose parameter.

Paket uses three different files (which are just plain text files):

- `paket.references` tells what components a single project (.fsproj) uses (if projects are in use).
- `paket.dependencies` tells the origins and all the components (and versions) that the whole application uses.
- `paket.lock` tells the reference trees: what component uses other and which versions. 

##### How to add new 3rd party component? #####

Add package name (from www.nuget.org) to `paket.dependencies`. Then run either:

- Windows: `.paket\paket.exe install`
- Mac/Linux: `mono .paket\paket.exe install`

This will automatically calculate your new `paket.lock` file.

### F-Sharp ###

F-Sharp (F#) is the programming language.
Some learning references:

- Some synonyms for common code blocks [here](http://www.slideshare.net/fullscreen/thorium/possible-fsharp-refactorings-could-be/).
- Advanced [tutorial](https://thorium.github.io/FSharpAzure/Readme.html) to create a [cloud-web-app](https://github.com/Thorium/CatVsDog).
- Finnish F# tutorial, [part1](https://bitbucket.org/ilmirajat/fsharptraining.fi/src/be03cf26fd6c61f70ef5516172c06f59eaf224d2/FSharpTraining/01-Basics.fsx?at=master) and [part2](https://bitbucket.org/ilmirajat/fsharptraining.fi/src/be03cf26fd6c61f70ef5516172c06f59eaf224d2/FSharpTraining/04-MoreAdvancedStuff.fsx?at=master)
- [fsharp.org](http://fsharp.org/) and [English tutorial](http://www.tryfsharp.org/Learn).

#### TypeProviders ####

We use F# Data type providers to avoid complex O/R-mappings and domain models:

- [F# Data](http://fsharp.github.io/FSharp.Data/)
- [SQLProvider](https://github.com/fsprojects/SQLProvider)
- [FSharp.Data.SqlClient](http://fsprojects.github.io/FSharp.Data.SqlClient/)

### OWIN ###

[Open Web Interface for .NET](http://owin.org/) is just a way to create a lightweight web-server.

### SignalR ###

[SignalR](http://signalr.net/) is a real-time communication library that can handle also push-based notifications from the server to the clients. It uses WebSockets and fallbacks for long-polling.

### Logary ###

[Logary] (https://logary.github.io/) is a logging library that makes it easy to integrate with many different "Operational Intelligence platforms" to gather real-time log data from distributed web-servers.

# Frontend #

This is just a basic HTML frontend.

We don't manage external JavaScript or stylesheet files in our code base: Files are listed to **Paket** just like on the server side. Files are fetched to the paket-files folder, and then the build script will copy these under the frontend lib folder.

As on the server side, **SignalR** is also used on the client side. It makes it possible to call server-side functions and also allows real-time communication via WebSocket or long-polling.

### Fonts ###

The current font has to be changed...

Fonts can be found from the [Google font site](https://www.google.com/fonts) and they can be converted to required formats via [FontSquirrel](http://www.fontsquirrel.com/tools/webfont-generator).

### Gulp ###

[Gulp](http://gulpjs.com/) is client-side task manager. You can run it just by typing "gulp" into the console. It is used as `gulpfile.js` describes:

 - Lint, aka. error-check Javascript files
 - Compile React.Js components to pure Javascript
 - Compile Less files to CSS-files.
 - Concatenate and minify CSS-files.
 - Concatenate external javascript libraries to a single file to save HTTP-requests and noise in html-header
 - Minify our Javascript files.
 - Create sourcemaps for debuging the minified files.
 - Watch changes to update dist-folder, which is the www-root for the web-server.

Gulp is used only in a development-time environment.
It is fetched through npm (the Node.js package manager).

### React.Js ###

[React.Js](http://facebook.github.io/react/) is a tool we use for creating HTML-template-components that are used in a) multiple HTML-files, b) multiple times in a page, e.g. search result item.

React.Js components are files that have the extension `*.jsx`, and they are in the js-folder. The downside is that you have to write HTML to JavaScript, but there are no good options. All *VM-frameworks (Angular2, Knockout, Aurelia, etc.) have their problems.

### Less / Sass ###

[Less](http://lesscss.org/) makes it possible to not repeat the same HTML-colors etc. in the stylesheets:

- You can define e.g. @brand-color: #123456; and use the alias in css-style so you don't have to change everything when the color changes; just manage it in one place.
- You can inherit styles to avoid repeating

Less-files are in the styles-folder, and basically normal css-syntax is also valid less-syntax. It has a good tutorial on its website.

If you prefer [Sass](http://sass-lang.com/) over Less, just use it: it will also be parsed from the same styles-folder.

### Foundation.css ###

Zurb [Foundation](http://foundation.zurb.com/) CSS is a responsive stylesheet. It is used to make HTML layouts like:

- [Grid](http://foundation.zurb.com/docs/components/grid.html): Responsive layout having 1-12 "columns" that are divided into multiple rows if the screen is too small.
- Vertical [Icon Bar](http://foundation.zurb.com/docs/components/icon-bar.html) -menu
- [Pages](http://foundation.zurb.com/docs/components/pagination.html) to list / search results
- [Thumbnail](http://foundation.zurb.com/docs/components/thumbnails.html) images
- [Form](http://foundation.zurb.com/docs/components/forms.html) layouts with [validations](http://foundation.zurb.com/docs/components/abide.html)
- [Range sliders](http://foundation.zurb.com/docs/components/range_slider.html)
- Radius [Buttons](http://foundation.zurb.com/docs/components/buttons.html) and secondary buttons
- Vertical [Tabs](http://foundation.zurb.com/docs/components/tabs.html#tabs-deeplink-3)
- ...and more.

Or if you would rather use [Twitter Bootstrap 4](https://v4-alpha.getbootstrap.com/), you can start writing its tags as they are included in the infrastructure as well.

### FontAwesome ###

To have icons in the user interface, we use [FontAwesome](http://fortawesome.github.io/Font-Awesome/) icon font. It has a [large collection](http://fortawesome.github.io/Font-Awesome/icons/) of vector graphic icons for the user interface. They are used inside buttons, menus, etc. You use them like this: `<span class="fa fa-book"></span>`

### Lodash ###

[Lodash](https://lodash.com/) is a Javascript library that helps you avoid writing loop structures in Javascript. You shouldn't use for, while, or any other loop as they are not easy to understand by just looking 3 sec to the source code. Instead, you should use collection operators like `map`, `filter`, `reduce` and `each`.

    var filtered = _.filter(myCollection, function(i){ return i % 2 == 0; });
    var plusOnes = _.map(filtered, function(i){ return i + 1; });
    var sumTotal = _.reduce(plusOnes, function(a, k){ return a + k; });
    _.each(plusOnes, function(i){ alert(i); });

Undescore could be changed to Lodash or we could just use ES6. They are the same, the point is to write "what computer should do", not "how computer should do" it.

### jQuery and jQuery-UI ###

jQuery is an old library to manipulate HTML-objects via JavaScript: `$("#myId").doStuff();`
You should know this already. 

jQuery-UI is used for some themed components like the [datepicker](https://jqueryui.com/datepicker/)-calendar.

### TypeScript ###

TypeScript is a statically typed transpiler for JavaScript. It supports ES6. 
http://www.typescriptlang.org/

Browserify (in gulpfile.js) compiles TypeScript files starting from frontend/scripts/_references.d.ts (references to external modules) and frontend/scripts/app.ts (references to compiled *.ts files as modules). If you have errors, the JavaScript files under www-server folder (dist) may not update.

## Possible some more technologies if needed ##

You should use a reactive programming library like:

- [RX.js](http://reactivex.io/)
- [Bacon.js](https://baconjs.github.io/)

These will make it easy to write event-based code. Use events as infinite lists and code event-based program state just as list operations.

Some kind of Javascript-side router may be taken into use for single-page-app:
e.g. [Crossroads.js](https://millermedeiros.github.io/crossroads.js/)

Other useful components:

- Web-testing: [canopy](http://lefthandedgoat.github.io/canopy/)
- Unit-testing: [FsUnit.xUnit](http://fsprojects.github.io/FsUnit/)
- Image-slider: [Slippry](http://slippry.com/)
- Localization-templates: [mustache.js](https://github.com/janl/mustache.js/)
- File-upload: [JQuery File Uploader](https://github.com/danielm/uploader/)
- Chart-library: [Rickshaw](https://github.com/shutterstock/rickshaw)
- Maps: [Google Maps] (https://developers.google.com/maps/documentation/javascript/)

If you want to avoid pure JavaScript (or ES6) coding, then you should probably use one of these:

- [FunScript](http://funscript.info/)
- [ClojureScript + React.JS](http://reagent-project.github.io/)
- [Elm](http://elm-lang.org/)
